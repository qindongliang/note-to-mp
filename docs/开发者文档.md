# NoteToMP å¼€å‘è€…æ–‡æ¡£

## ç›®å½•
- [1. é¡¹ç›®æ¦‚è¿°](#1-é¡¹ç›®æ¦‚è¿°)
- [2. å¼€å‘ç¯å¢ƒæ­å»º](#2-å¼€å‘ç¯å¢ƒæ­å»º)
- [3. é¡¹ç›®ç»“æ„](#3-é¡¹ç›®ç»“æ„)
- [4. æ ¸å¿ƒæ¨¡å—](#4-æ ¸å¿ƒæ¨¡å—)
- [5. API å‚è€ƒ](#5-api-å‚è€ƒ)
- [6. æ‰©å±•å¼€å‘](#6-æ‰©å±•å¼€å‘)
- [7. è´¡çŒ®æŒ‡å—](#7-è´¡çŒ®æŒ‡å—)
- [8. è°ƒè¯•æŒ‡å—](#8-è°ƒè¯•æŒ‡å—)
- [9. æµ‹è¯•](#9-æµ‹è¯•)
- [10. å‘å¸ƒæµç¨‹](#10-å‘å¸ƒæµç¨‹)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 å…³äº NoteToMP

NoteToMP æ˜¯ä¸€ä¸ªå¼€æºçš„ Obsidian æ’ä»¶ï¼Œæ—¨åœ¨å®ç°ç¬”è®°åˆ°å¾®ä¿¡å…¬ä¼—å·ç¼–è¾‘å™¨çš„å®Œç¾åŒæ­¥ã€‚æœ¬é¡¹ç›®é‡‡ç”¨ TypeScript å¼€å‘ï¼Œä½¿ç”¨ç°ä»£åŒ–çš„å¼€å‘å·¥å…·é“¾ã€‚

### 1.2 æŠ€æœ¯æ ˆ

- **è¯­è¨€**ï¼šTypeScript 4.7.4
- **æ„å»ºå·¥å…·**ï¼šESBuild 0.17.3
- **ä¾èµ–ç®¡ç†**ï¼šnpm
- **ä»£ç æ£€æŸ¥**ï¼šESLint + TypeScript ESLint
- **Obsidian API**ï¼šlatest

### 1.3 æ ¸å¿ƒåŠŸèƒ½

- Markdown æ¸²æŸ“ä¸è½¬æ¢
- å¤šä¸»é¢˜ç³»ç»Ÿ
- ä»£ç é«˜äº®æ”¯æŒ
- æ•°å­¦å…¬å¼æ¸²æŸ“ï¼ˆLaTeX & AsciiMathï¼‰
- å›¾ç‰‡å¤„ç†ä¸ä¸Šä¼ 
- å¾®ä¿¡ API é›†æˆ
- è‡ªå®šä¹‰ CSS æ”¯æŒ

### 1.4 è®¸å¯è¯

æœ¬é¡¹ç›®ä½¿ç”¨ MIT è®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](../LICENSE)

---

## 2. å¼€å‘ç¯å¢ƒæ­å»º

### 2.1 ç¯å¢ƒè¦æ±‚

- Node.js 16+
- npm 8+
- Obsidian 1.4.5+

### 2.2 å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/sunbooshi/note-to-mp.git
cd note-to-mp
```

### 2.3 å®‰è£…ä¾èµ–

```bash
npm install
```

### 2.4 å¼€å‘æ¨¡å¼

```bash
# å¯åŠ¨å¼€å‘æ¨¡å¼ï¼ˆç›‘å¬æ–‡ä»¶å˜åŒ–ï¼Œè‡ªåŠ¨æ„å»ºï¼‰
npm run dev
```

### 2.5 ç”Ÿäº§æ„å»º

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

### 2.6 è¿æ¥åˆ° Obsidian

1. åˆ›å»ºç¬¦å·é“¾æ¥ï¼ˆmacOS/Linuxï¼‰ï¼š
```bash
ln -s /path/to/note-to-mp ~/.obsidian/plugins/note-to-mp
```

2. æˆ–åœ¨ Obsidian ä¸­ï¼š
   - è®¾ç½® â†’ ç¬¬ä¸‰æ–¹æ’ä»¶ â†’ å¼€å‘æ¨¡å¼
   - åŠ è½½å¸è½½æ’ä»¶
   - é€‰æ‹© `note-to-mp` æ–‡ä»¶å¤¹

---

## 3. é¡¹ç›®ç»“æ„

```
note-to-mp/
â”œâ”€â”€ assets/                  # ä¸»é¢˜å’Œä»£ç é«˜äº®èµ„æº
â”‚   â”œâ”€â”€ themes/              # ä¸»é¢˜æ–‡ä»¶
â”‚   â”œâ”€â”€ highlights/          # ä»£ç é«˜äº®æ ·å¼
â”‚   â”œâ”€â”€ themes.json          # ä¸»é¢˜ç´¢å¼•
â”‚   â””â”€â”€ highlights.json      # é«˜äº®ç´¢å¼•
â”œâ”€â”€ docs/                    # æ–‡æ¡£ç›®å½•
â”œâ”€â”€ src/                     # æºç ç›®å½•
â”‚   â”œâ”€â”€ main.ts              # æ’ä»¶å…¥å£
â”‚   â”œâ”€â”€ settings.ts          # è®¾ç½®ç®¡ç†
â”‚   â”œâ”€â”€ setting-tab.ts       # è®¾ç½®ç•Œé¢
â”‚   â”œâ”€â”€ assets.ts            # èµ„æºç®¡ç†
â”‚   â”œâ”€â”€ utils.ts             # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ note-preview.ts      # é¢„è§ˆè§†å›¾
â”‚   â”œâ”€â”€ article-render.ts    # æ–‡ç« æ¸²æŸ“
â”‚   â”œâ”€â”€ widgets-modal.ts     # å°éƒ¨ä»¶æ¨¡æ€æ¡†
â”‚   â”œâ”€â”€ weixin-api.ts        # å¾®ä¿¡ API
â”‚   â”œâ”€â”€ imagelib.ts          # å›¾ç‰‡åº“
â”‚   â”œâ”€â”€ doc-modal.ts         # æ–‡æ¡£æ¨¡æ€æ¡†
â”‚   â”œâ”€â”€ expert-settings.ts   # ä¸“å®¶è®¾ç½®
â”‚   â”œâ”€â”€ inline-css.ts        # å†…è” CSS
â”‚   â”œâ”€â”€ markdown/            # Markdown å¤„ç†
â”‚   â”‚   â”œâ”€â”€ parser.ts        # è§£æå™¨
â”‚   â”‚   â”œâ”€â”€ code.ts          # ä»£ç å—å¤„ç†
â”‚   â”‚   â”œâ”€â”€ heading.ts       # æ ‡é¢˜å¤„ç†
â”‚   â”‚   â”œâ”€â”€ link.ts          # é“¾æ¥å¤„ç†
â”‚   â”‚   â”œâ”€â”€ math.ts          # æ•°å­¦å…¬å¼
â”‚   â”‚   â”œâ”€â”€ callouts.ts      # Callout å¤„ç†
â”‚   â”‚   â”œâ”€â”€ footnote.ts      # è„šæ³¨
â”‚   â”‚   â”œâ”€â”€ icons.ts         # å›¾æ ‡
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ wasm/                # WebAssembly
â”œâ”€â”€ styles.css               # æ’ä»¶æ ·å¼
â”œâ”€â”€ manifest.json            # æ’ä»¶æ¸…å•
â”œâ”€â”€ package.json             # åŒ…é…ç½®
â”œâ”€â”€ tsconfig.json            # TypeScript é…ç½®
â”œâ”€â”€ esbuild.config.mjs       # ESBuild é…ç½®
â””â”€â”€ version-bump.mjs         # ç‰ˆæœ¬ç®¡ç†è„šæœ¬
```

### 3.1 æ ¸å¿ƒç›®å½•è¯´æ˜

**src/** - åŒ…å«æ‰€æœ‰ TypeScript æºç 
- **main.ts**ï¼šæ’ä»¶å…¥å£ç‚¹ï¼Œåˆå§‹åŒ–æ‰€æœ‰ç»„ä»¶
- **note-preview.ts**ï¼šé¢„è§ˆè§†å›¾çš„é€»è¾‘
- **article-render.ts**ï¼šæ ¸å¿ƒæ¸²æŸ“å¼•æ“
- **markdown/**ï¼šMarkdown æ‰©å±•å®ç°

**assets/** - é™æ€èµ„æº
- ä¸»é¢˜ CSS æ–‡ä»¶
- ä»£ç é«˜äº® CSS æ–‡ä»¶
- JSON ç´¢å¼•æ–‡ä»¶

**docs/** - æ–‡æ¡£
- ç”¨æˆ·æ‰‹å†Œ
- å¼€å‘æ–‡æ¡£
- FAQ ç­‰

---

## 4. æ ¸å¿ƒæ¨¡å—

### 4.1 ä¸»æ¨¡å— (main.ts)

ä¸»æ¨¡å—è´Ÿè´£æ’ä»¶çš„åˆå§‹åŒ–å’Œæ•´ä½“åè°ƒï¼š

```typescript
export default class NoteToMpPlugin extends Plugin {
    settings: NMPSettings;           // æ’ä»¶è®¾ç½®
    assetsManager: AssetsManager;    // èµ„æºç®¡ç†å™¨

    constructor(app: App, manifest: PluginManifest) {
        super(app, manifest);
        AssetsManager.setup(app, manifest);
        this.assetsManager = AssetsManager.getInstance();
    }

    async onload() {
        // åŠ è½½è®¾ç½®å’Œèµ„æº
        await this.loadResource();

        // æ³¨å†Œé¢„è§ˆè§†å›¾
        this.registerView(VIEW_TYPE_NOTE_PREVIEW, (leaf) => new NotePreview(leaf, this));

        // æ·»åŠ å‘½ä»¤
        this.addCommand({
            id: 'note-to-mp-preview',
            name: 'å¤åˆ¶åˆ°å…¬ä¼—å·',
            callback: () => this.activateView()
        });

        // æ·»åŠ è®¾ç½®é¢æ¿
        this.addSettingTab(new NoteToMpSettingTab(this.app, this));
    }
}
```

### 4.2 è®¾ç½®ç®¡ç† (settings.ts)

å®šä¹‰æ’ä»¶çš„æ‰€æœ‰é…ç½®é€‰é¡¹ï¼š

```typescript
export interface NMPSettings {
    // ä¸»é¢˜ç›¸å…³
    defaultTheme: string;
    customCssNote: string;

    // ä»£ç é«˜äº®
    defaultHighlight: string;
    showLineNumbers: boolean;

    // æ•°å­¦å…¬å¼
    mathSyntax: 'latex' | 'asciimath';

    // å¾®ä¿¡è®¾ç½®
    wechatAccounts: WechatAccount[];
    defaultAccount: string;

    // å…¶ä»–é€‰é¡¹...
}
```

### 4.3 èµ„æºç®¡ç†å™¨ (assets.ts)

è´Ÿè´£åŠ è½½å’Œç®¡ç†ä¸»é¢˜ã€ä»£ç é«˜äº®ç­‰èµ„æºï¼š

```typescript
export default class AssetsManager {
    private static instance: AssetsManager;
    private themes: Map<string, string> = new Map();
    private highlights: Map<string, string> = new Map();

    async loadAssets(): Promise<void> {
        // åŠ è½½ä¸»é¢˜ç´¢å¼•
        const themesIndex = await this.loadJson('assets/themes.json');
        // åŠ è½½é«˜äº®ç´¢å¼•
        const highlightsIndex = await this.loadJson('assets/highlights.json');
        // åŠ è½½ CSS å†…å®¹
        await this.loadThemeFiles(themesIndex);
        await this.loadHighlightFiles(highlightsIndex);
    }

    getTheme(name: string): string | undefined {
        return this.themes.get(name);
    }

    getHighlight(name: string): string | undefined {
        return this.highlights.get(name);
    }
}
```

### 4.4 é¢„è§ˆè§†å›¾ (note-preview.ts)

å®ç°æ’ä»¶çš„é¢„è§ˆç•Œé¢ï¼š

```typescript
export class NotePreview extends ItemView {
    private plugin: NoteToMpPlugin;
    private currentFile: TFile | null = null;

    constructor(leaf: WorkspaceLeaf, plugin: NoteToMpPlugin) {
        super(leaf);
        this.plugin = plugin;
    }

    getViewType(): string {
        return VIEW_TYPE_NOTE_PREVIEW;
    }

    getDisplayText(): string {
        return 'NoteToMP Preview';
    }

    async onOpen(): Promise<void> {
        // åˆ›å»º UI
        const container = this.containerEl.children[1];
        container.empty();
        container.createEl('div', { cls: 'note-to-mp-container' });

        // ç»‘å®šäº‹ä»¶
        this.registerEvent();
    }

    async renderNote(file: TFile): Promise<void> {
        // è·å–ç¬”è®°å†…å®¹
        const content = await this.app.vault.read(file);

        // æ¸²æŸ“ Markdown
        const html = await ArticleRenderer.render(content);

        // æ›´æ–°é¢„è§ˆ
        this.updatePreview(html);
    }
}
```

### 4.5 æ–‡ç« æ¸²æŸ“å™¨ (article-render.ts)

æ ¸å¿ƒæ¸²æŸ“å¼•æ“ï¼Œè´Ÿè´£å°† Markdown è½¬æ¢ä¸º HTMLï¼š

```typescript
export class ArticleRenderer {
    static async render(markdown: string): Promise<string> {
        // åˆ›å»ºè§£æå™¨å®ä¾‹
        const parser = new MarkdownParser();

        // æ·»åŠ å„ç§æ‰©å±•
        parser.addExtension(new CodeExtension());
        parser.addExtension(new HeadingExtension());
        parser.addExtension(new LinkExtension());
        parser.addExtension(new MathExtension());
        parser.addExtension(new CalloutExtension());

        // è§£æä¸º HTML
        return await parser.parse(markdown);
    }
}
```

### 4.6 Markdown æ‰©å±•

æ¯ä¸ª Markdown åŠŸèƒ½éƒ½é€šè¿‡ç‹¬ç«‹çš„æ‰©å±•æ¨¡å—å®ç°ï¼š

**ä»£ç é«˜äº® (code.ts)ï¼š**
```typescript
export class CodeExtension implements MarkdownExtension {
    name = 'code';

    renderer(node: CodeNode): string {
        const { code, language, lineNumbers } = node;
        const highlighted = this.highlightCode(code, language);
        return `<pre><code class="language-${language}">${highlighted}</code></pre>`;
    }

    private highlightCode(code: string, language: string): string {
        // ä½¿ç”¨ highlight.js è¿›è¡Œé«˜äº®
        return hljs.highlight(code, { language }).value;
    }
}
```

**æ•°å­¦å…¬å¼ (math.ts)ï¼š**
```typescript
export class MathExtension implements MarkdownExtension {
    name = 'math';

    renderer(node: MathNode): string {
        const { formula, type } = node;
        if (type === 'inline') {
            return `<span class="math-inline">${formula}</span>`;
        } else {
            return `<div class="math-display">${formula}</div>`;
        }
    }
}
```

---

## 5. API å‚è€ƒ

### 5.1 æ’ä»¶ API

#### NoteToMpPlugin

```typescript
class NoteToMpPlugin {
    /** æ’ä»¶è®¾ç½® */
    settings: NMPSettings;

    /** èµ„æºç®¡ç†å™¨ */
    assetsManager: AssetsManager;

    /** æ¿€æ´»é¢„è§ˆè§†å›¾ */
    activateView(): Promise<void>;

    /** è·å–å½“å‰é¢„è§ˆå®ä¾‹ */
    getNotePreview(): NotePreview | null;

    /** ä¿å­˜è®¾ç½® */
    saveSettings(): Promise<void>;
}
```

#### èµ„æºç®¡ç† API

```typescript
class AssetsManager {
    /** è·å–å•ä¾‹å®ä¾‹ */
    static getInstance(): AssetsManager;

    /** åŠ è½½æ‰€æœ‰èµ„æº */
    loadAssets(): Promise<void>;

    /** è·å–ä¸»é¢˜ CSS */
    getTheme(name: string): string | undefined;

    /** è·å–ä»£ç é«˜äº® CSS */
    getHighlight(name: string): string | undefined;

    /** è·å–æ‰€æœ‰ä¸»é¢˜åˆ—è¡¨ */
    getThemesList(): string[];

    /** è·å–æ‰€æœ‰é«˜äº®åˆ—è¡¨ */
    getHighlightsList(): string[];
}
```

#### è®¾ç½® API

```typescript
interface NMPSettings {
    // ä¸»é¢˜è®¾ç½®
    defaultTheme: string;
    customCssNote: string;

    // ä»£ç é«˜äº®è®¾ç½®
    defaultHighlight: string;
    showLineNumbers: boolean;

    // æ•°å­¦å…¬å¼è®¾ç½®
    mathSyntax: 'latex' | 'asciimath';

    // å¾®ä¿¡è´¦å·è®¾ç½®
    wechatAccounts: WechatAccount[];
    defaultAccount: string;
}

interface WechatAccount {
    id: string;
    name: string;
    appId: string;
    appSecret: string;
    accessToken?: string;
}
```

### 5.2 æ¸²æŸ“ API

#### MarkdownParser

```typescript
class MarkdownParser {
    /** æ·»åŠ æ‰©å±• */
    addExtension(extension: MarkdownExtension): void;

    /** è§£æ Markdown ä¸º HTML */
    parse(markdown: string): Promise<string>;
}

interface MarkdownExtension {
    /** æ‰©å±•åç§° */
    name: string;

    /** æ¸²æŸ“èŠ‚ç‚¹ä¸º HTML */
    renderer(node: any): string;
}
```

#### ArticleRenderer

```typescript
class ArticleRenderer {
    /** æ¸²æŸ“æ•´ç¯‡æ–‡ç«  */
    static async render(content: string): Promise<string>;

    /** æ¸²æŸ“å•ä¸ªèŠ‚ç‚¹ */
    static renderNode(node: ASTNode): string;

    /** åº”ç”¨ä¸»é¢˜æ ·å¼ */
    static applyTheme(html: string, themeName: string): string;

    /** åº”ç”¨ä»£ç é«˜äº® */
    static applyHighlight(html: string, highlightName: string): string;
}
```

---

## 6. æ‰©å±•å¼€å‘

### 6.1 æ·»åŠ æ–°çš„ Markdown æ‰©å±•

æ­¥éª¤ï¼š

1. **åˆ›å»ºæ‰©å±•æ–‡ä»¶**
```typescript
// src/markdown/my-extension.ts
import { MarkdownExtension } from './extension';

export class MyExtension implements MarkdownExtension {
    name = 'my-extension';

    renderer(node: any): string {
        // å®ç°æ¸²æŸ“é€»è¾‘
        return `<div class="my-custom">${node.content}</div>`;
    }
}
```

2. **åœ¨è§£æå™¨ä¸­æ³¨å†Œ**
```typescript
// src/article-render.ts
import { MyExtension } from './markdown/my-extension';

const parser = new MarkdownParser();
parser.addExtension(new MyExtension());
```

3. **æ·»åŠ æ ·å¼**
```css
/* styles.css */
.note-to-mp .my-custom {
    padding: 10px;
    background: #f0f0f0;
}
```

### 6.2 æ·»åŠ æ–°ä¸»é¢˜

æ­¥éª¤ï¼š

1. **åˆ›å»ºä¸»é¢˜æ–‡ä»¶**
```css
/* assets/themes/my-theme.css */
.note-to-mp {
    font-family: 'Arial', sans-serif;
    line-height: 1.8;
}

.note-to-mp h1 {
    color: #2c3e50;
    font-size: 2em;
}

/* æ›´å¤šæ ·å¼... */
```

2. **æ›´æ–°ä¸»é¢˜ç´¢å¼•**
```json
// assets/themes.json
{
    "my-theme": {
        "name": "æˆ‘çš„ä¸»é¢˜",
        "description": "ç®€æ´ç°ä»£çš„ä¸»é¢˜",
        "author": "Your Name",
        "version": "1.0.0"
    }
}
```

3. **æµ‹è¯•ä¸»é¢˜**
```typescript
// åœ¨æ’ä»¶è®¾ç½®ä¸­æ·»åŠ é¢„è§ˆ
const themes = await this.assetsManager.getThemesList();
console.log(themes);
```

### 6.3 æ·»åŠ æ–°çš„ä»£ç é«˜äº®

æ­¥éª¤ï¼š

1. **åˆ›å»ºé«˜äº®æ–‡ä»¶**
```css
/* assets/highlights/my-highlight.css */
.hljs {
    background: #f5f5f5;
    color: #333;
}

.hljs-keyword {
    color: #007acc;
    font-weight: bold;
}

.hljs-string {
    color: #669900;
}

/* æ›´å¤šæ ·å¼... */
```

2. **æ›´æ–°é«˜äº®ç´¢å¼•**
```json
// assets/highlights.json
{
    "my-highlight": {
        "name": "æˆ‘çš„é«˜äº®",
        "description": "è‡ªå®šä¹‰ä»£ç é«˜äº®ä¸»é¢˜"
    }
}
```

### 6.4 è‡ªå®šä¹‰æ¸²æŸ“å™¨

æ‚¨å¯ä»¥å®Œå…¨è‡ªå®šä¹‰æ¸²æŸ“é€»è¾‘ï¼š

```typescript
export class CustomRenderer {
    async render(markdown: string): Promise<string> {
        // è‡ªå®šä¹‰è§£æé€»è¾‘
        const tokens = this.parseTokens(markdown);

        // è½¬æ¢ä¸º HTML
        return tokens.map(token => this.renderToken(token)).join('\n');
    }

    private parseTokens(markdown: string): Token[] {
        // å®ç°è‡ªå®šä¹‰è§£æå™¨
    }

    private renderToken(token: Token): string {
        // å®ç°è‡ªå®šä¹‰æ¸²æŸ“
    }
}
```

---

## 7. è´¡çŒ®æŒ‡å—

### 7.1 å¦‚ä½•è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼

1. **æŠ¥å‘Š Bug**
   - ä½¿ç”¨ GitHub Issues
   - æä¾›è¯¦ç»†çš„é‡ç°æ­¥éª¤
   - åŒ…å«ç¯å¢ƒå’Œç‰ˆæœ¬ä¿¡æ¯

2. **æäº¤åŠŸèƒ½å»ºè®®**
   - åœ¨ Issues ä¸­ä½¿ç”¨ "Feature Request" æ ‡ç­¾
   - è¯¦ç»†æè¿°åŠŸèƒ½å’Œç”¨ä¾‹

3. **æäº¤ä»£ç **
   - Fork é¡¹ç›®
   - åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
   - æäº¤ Pull Request

### 7.2 å¼€å‘è§„èŒƒ

**ä»£ç é£æ ¼ï¼š**
- ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- éµå¾ª ESLint è§„åˆ™
- ä½¿ç”¨ 4 ä¸ªç©ºæ ¼ç¼©è¿›
- ä½¿ç”¨æœ‰æ„ä¹‰çš„å˜é‡å

**æäº¤ä¿¡æ¯æ ¼å¼ï¼š**
```
<type>(<scope>): <subject>

<body>

<footer>
```

ç±»å‹åŒ…æ‹¬ï¼š
- feat: æ–°åŠŸèƒ½
- fix: Bug ä¿®å¤
- docs: æ–‡æ¡£æ›´æ–°
- style: ä»£ç æ ¼å¼
- refactor: é‡æ„
- test: æµ‹è¯•
- chore: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

ç¤ºä¾‹ï¼š
```
feat(markdown): æ·»åŠ  AsciiMath æ”¯æŒ

æ”¯æŒ AsciiMath è¯­æ³•ç”¨äºæ•°å­¦å…¬å¼æ¸²æŸ“
- æ·»åŠ  asciimath è§£æå™¨
- æ›´æ–° UI è®¾ç½®é€‰é¡¹
- æ·»åŠ æµ‹è¯•ç”¨ä¾‹

Closes #123
```

### 7.3 Pull Request æµç¨‹

1. **Fork é¡¹ç›®**
```bash
git clone https://github.com/your-username/note-to-mp.git
```

2. **åˆ›å»ºåˆ†æ”¯**
```bash
git checkout -b feature/my-new-feature
```

3. **å¼€å‘å¹¶æµ‹è¯•**
```bash
npm run dev
# æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
```

4. **æäº¤æ›´æ”¹**
```bash
git commit -m "feat: add new feature"
git push origin feature/my-new-feature
```

5. **åˆ›å»º PR**
   - è®¿é—® GitHub
   - åˆ›å»º Pull Request
   - å¡«å†™è¯¦ç»†æè¿°

### 7.4 ä»£ç å®¡æŸ¥æ¸…å•

æäº¤ PR å‰è¯·è‡ªæ£€ï¼š

- [ ] ä»£ç ç¬¦åˆ TypeScript è§„èŒƒ
- [ ] é€šè¿‡ ESLint æ£€æŸ¥
- [ ] æ·»åŠ å¿…è¦çš„æ³¨é‡Š
- [ ] æ›´æ–°ç›¸å…³æ–‡æ¡£
- [ ] æ·»åŠ æµ‹è¯•ç”¨ä¾‹
- [ ] æµ‹è¯•æ–°åŠŸèƒ½

---

## 8. è°ƒè¯•æŒ‡å—

### 8.1 å¯ç”¨è°ƒè¯•æ¨¡å¼

```typescript
// åœ¨ main.ts ä¸­å¯ç”¨è¯¦ç»†æ—¥å¿—
this.app.workspace.onLayoutReady(()=>{
    console.log('NoteToMP Debug Mode Enabled');
});
```

### 8.2 æŸ¥çœ‹æ—¥å¿—

**æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼š**
- æŒ‰ `F12` æ‰“å¼€
- åˆ‡æ¢åˆ° Console é€‰é¡¹å¡
- è¿‡æ»¤ "NoteToMP" å…³é”®è¯

**Obsidian å¼€å‘è€…æ§åˆ¶å°ï¼š**
- è®¾ç½® â†’ å…³äº â†’ æ‰“å¼€æ—¥å¿—æ–‡ä»¶å¤¹

### 8.3 å¸¸è§é—®é¢˜è°ƒè¯•

**é—®é¢˜ï¼šä¸»é¢˜ä¸åŠ è½½**
```typescript
// æ£€æŸ¥ä¸»é¢˜ç´¢å¼•
console.log(await this.assetsManager.loadJson('assets/themes.json'));

// æ£€æŸ¥ä¸»é¢˜æ–‡ä»¶
console.log(await this.assetsManager.loadText('assets/themes/maple.css'));
```

**é—®é¢˜ï¼šé¢„è§ˆä¸æ›´æ–°**
```typescript
// å¼ºåˆ¶é‡æ–°æ¸²æŸ“
await this.renderNote(this.currentFile);

// æˆ–è€…é‡æ–°åŠ è½½è§†å›¾
this.app.workspace.detachLeavesOfType(VIEW_TYPE_NOTE_PREVIEW);
```

**é—®é¢˜ï¼šè®¾ç½®ä¸ä¿å­˜**
```typescript
// æ£€æŸ¥è®¾ç½®
console.log(this.settings);

// å¼ºåˆ¶ä¿å­˜
await this.saveSettings();
```

### 8.4 ä½¿ç”¨æ–­ç‚¹è°ƒè¯•

1. åœ¨ VS Code ä¸­æ‰“å¼€é¡¹ç›®
2. å®‰è£… "ESBuild" è°ƒè¯•é…ç½®
3. åœ¨ä»£ç ä¸­æ·»åŠ  `debugger;` è¯­å¥
4. å¯åŠ¨è°ƒè¯•æ¨¡å¼

### 8.5 æ€§èƒ½åˆ†æ

**æµ‹é‡æ¸²æŸ“æ—¶é—´ï¼š**
```typescript
const start = performance.now();
await ArticleRenderer.render(markdown);
const end = performance.now();
console.log(`Render time: ${end - start}ms`);
```

**åˆ†æå†…å­˜ä½¿ç”¨ï¼š**
```typescript
// å¯ç”¨å†…å­˜ç›‘æ§
const used = process.memoryUsage();
console.log(used);
```

---

## 9. æµ‹è¯•

### 9.1 å•å…ƒæµ‹è¯•

é¡¹ç›®ä½¿ç”¨ Jest è¿›è¡Œå•å…ƒæµ‹è¯•ï¼š

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæµ‹è¯•
npm test -- --testNamePattern="Markdown Parser"

# ç›‘å¬æ¨¡å¼
npm test -- --watch
```

**æµ‹è¯•ç¤ºä¾‹ï¼š**
```typescript
// tests/markdown/parser.test.ts
import { MarkdownParser } from '../../src/markdown/parser';

describe('MarkdownParser', () => {
    it('should parse headers', () => {
        const parser = new MarkdownParser();
        const result = parser.parse('# Header 1');
        expect(result).toContain('<h1>');
    });

    it('should parse code blocks', () => {
        const parser = new MarkdownParser();
        const result = parser.parse('```javascript\nconst x = 1;\n```');
        expect(result).toContain('language-javascript');
    });
});
```

### 9.2 é›†æˆæµ‹è¯•

```typescript
// tests/integration/render.test.ts
import { ArticleRenderer } from '../../src/article-render';

describe('ArticleRenderer Integration', () => {
    it('should render full article', async () => {
        const markdown = `# Title\n\n**Bold** text\n\n\`\`\`js\nconst x = 1;\n\`\`\``;
        const html = await ArticleRenderer.render(markdown);

        expect(html).toContain('<h1>');
        expect(html).toContain('<strong>');
        expect(html).toContain('<pre><code');
    });
});
```

### 9.3 E2E æµ‹è¯•

ä½¿ç”¨ Cypress è¿›è¡Œç«¯åˆ°ç«¯æµ‹è¯•ï¼š

```bash
# å¯åŠ¨æµ‹è¯•æœåŠ¡å™¨
npm run test:server

# è¿è¡Œ E2E æµ‹è¯•
npm run test:e2e
```

### 9.4 æµ‹è¯•è¦†ç›–ç‡

```bash
# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# æŸ¥çœ‹æŠ¥å‘Š
open coverage/index.html
```

---

## 10. å‘å¸ƒæµç¨‹

### 10.1 ç‰ˆæœ¬ç®¡ç†

é¡¹ç›®ä½¿ç”¨ semver ç‰ˆæœ¬è§„èŒƒï¼š
- `MAJOR.MINOR.PATCH`
- `MAJOR`: ä¸å…¼å®¹çš„ API å˜æ›´
- `MINOR`: å‘åå…¼å®¹çš„æ–°åŠŸèƒ½
- `PATCH`: å‘åå…¼å®¹çš„ Bug ä¿®å¤

### 10.2 æ›´æ–°ç‰ˆæœ¬å·

```bash
# è‡ªåŠ¨æ›´æ–°ç‰ˆæœ¬å·
npm run version

# æ‰‹åŠ¨æ›´æ–°
# 1. ç¼–è¾‘ package.json
# 2. ç¼–è¾‘ manifest.json
# 3. ç¼–è¾‘ versions.json
```

### 10.3 æ„å»ºå‘å¸ƒåŒ…

```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build

# æ£€æŸ¥æ„å»ºäº§ç‰©
ls -la dist/
```

### 10.4 åˆ›å»ºå‘å¸ƒ

1. **æ›´æ–° CHANGELOG.md**
```markdown
## [1.3.2] - 2024-01-15

### æ–°å¢
- æ”¯æŒ AsciiMath è¯­æ³•

### ä¿®å¤
- ä¿®å¤å›¾ç‰‡ä¸Šä¼ å¤±è´¥çš„é—®é¢˜
```

2. **åˆ›å»º GitHub Release**
```bash
git tag v1.3.2
git push origin v1.3.2
```

3. **ä¸Šä¼ åˆ° Obsidian å¸‚åœº**
   - ç™»å½• Obsidian æ’ä»¶å¸‚åœº
   - ä¸Šä¼ æ„å»ºäº§ç‰©

### 10.5 è‡ªåŠ¨åŒ–æµç¨‹

ä½¿ç”¨ GitHub Actions è‡ªåŠ¨æ„å»ºå’Œå‘å¸ƒï¼š

```yaml
# .github/workflows/release.yml
name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
        with:
          node-version: '16'
      - run: npm install
      - run: npm run build
      - run: npm test
      - uses: softprops/action-gh-release@v1
        with:
          files: dist/*
```

---

## é™„å½•

### A. å‚è€ƒèµ„æº

- [Obsidian æ’ä»¶å¼€å‘æ–‡æ¡£](https://docs.obsidian.md/Plugins/iOS)
- [TypeScript å®˜æ–¹æ–‡æ¡£](https://www.typescriptlang.org/docs/)
- [ESBuild æ–‡æ¡£](https://esbuild.github.io/)
- [highlight.js æ–‡æ¡£](https://highlightjs.readthedocs.io/)

### B. ç›¸å…³é“¾æ¥

- [é¡¹ç›®ä»“åº“](https://github.com/sunbooshi/note-to-mp)
- [æ’ä»¶å¸‚åœºé¡µé¢](https://obsidian.md/plugins?id=note-to-mp)
- [é—®é¢˜åé¦ˆ](https://github.com/sunbooshi/note-to-mp/issues)

### C. è”ç³»æ–¹å¼

- ä½œè€…ï¼šSun Booshi
- é‚®ç®±ï¼šè¯·æŸ¥çœ‹ GitHub ä¸»é¡µ
- å¾®ä¿¡ï¼šGenius35Plus

---

**æ„Ÿè°¢æ‚¨çš„è´¡çŒ®ï¼** ğŸš€
